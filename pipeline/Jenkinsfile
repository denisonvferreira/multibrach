pipeline {
    agent any
    stages {
        stage('Hello') {
               when {
                    anyOf { 
                        branch 'main*'
                        branch 'dev*'
                    }
               }
            steps {
		    script{
			    mail to:"denison.ferreira@hotmail.com.br",
				subject: "Job '${env.JOB_NAME}' (${env.BUILD_NUMBER}) sucess.",
				body: "${currentBuild.currentResult}: Job ${env.JOB_NAME}\nMore Info can be found here: ${env.BUILD_URL}"
			    timeout(time: 30, unit: 'MINUTES') {
				    try{
					 userInput = input(
					 id: 'Proceed1', message: 'Confirma a RC?', parameters: [
					 [$class: 'BooleanParameterDefinition', defaultValue: true, description: '', name: 'Confirma o deploy?']
					 ])
				    } catch(err) {
					    userInput = false
				    }
				    if (userInput == true){
					    echo "tageando imagem buildada"
					    echo "Buildando imagem nova"
				    } else {
					    echo "apagando imagem buildada"
					    docker ps
				    }
			    } 
			    
// 	    	    	def jobName = new Date()
// 				jobName = jobName.format("yyyyMMddHHmmss", TimeZone.getTimeZone('UTC'))
// 		        	currentBuild.displayName = "$jobName"
// 		        	jobName = "teste-nome"+"_"+jobName
// 				node {
// 					echo "job name $jobName"
// 				}
			sh'''
			echo $jobName
			'''			
		    }
	    }
    
	}

    }
//     post{
//     	always{
// 		mail to:"denison.ferreira@hotmail.com.br",
// 		subject: "Test Email",
// 		body: "Test"
// 	}
//     }
//     post{
//     	failure{
// 		mail to:"denison.ferreira@hotmail.com.br",
// 		subject: "Test Email",
// 			body: "${currentBuild.currentResult}: Job ${env.JOB_NAME}\nMore Info can be found here: ${env.BUILD_URL}"
// 	}
//     }

}
